#!/bin/bash
readonly REPOSITORY_DIR=$1

[[ -z $REPOSITORY_DIR ]] \
    && echo "$0 <repository dir>" \
    && exit 1

generate_index() {
    local index_type=$1 # binary, source
    local index_name=$2 # Packages, Sources

    dpkg-scanpackages $index_type /dev/null \
        | gzip -9c > $index_type/$index_name.gz
}

generate_binary_index() {
    generate_index binary Packages
}

generate_sources_index() {
    generate_index source Sources
}

main() {
    cd $REPOSITORY_DIR
    generate_binary_index
    generate_sources_index
}
main

# took from http://linux.koolsolutions.com/2009/09/21/howto-create-your-own-local-debian-repository/
